#+TITLE: Microservicio Login - API
#+AUTHOR: fran
#+LANGUAGE: es
#+STARTUP: content indent showeverything
#+DESCRIPTION: API del microservicio Login
#+PROPERTY: header-args:verb :wrap src ob-verb-response
#+OPTIONS: results:t
* API :verb:
template http://localhost:4567
Accept: application/json
** Usuarios
*** Alta
Crea un nuevo usuario en la bd.
#+begin_src verb
  post /registrar
  Content-Type: application/json; charset=utf-8

  {
  "usuario": "testeowachin",
  "email": "testeomanito@test.com",
  "nombre": "eaeaea",
  "contra": "easdasdaeaea"
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:44:42 GMT
Content-Length: 27

{
  "mensaje": "Alta exitosa"
}
#+end_src

*** Login
#+begin_src verb
  post /login
  Content-Type: application/json; charset=utf-8

  {
  "usuario": "fran",
  "contra": "123"
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:44:58 GMT
Content-Length: 349

{
  "permisos": "USUARIO_ALTA, USUARIO_BAJA, USUARIO_LISTAR, USUARIO_MODIFICAR",
  "rol": "ADMIN",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1Njc4OTgsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.E2KyiTIhCYWfwvimy-aIU1Cw2quHnC6Y3gHLlKYZrpM"
}
#+end_src


*** Alta permiso
#+begin_src verb
  post /p/usuario/6/rol
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjY0NjYsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.Mcxu-5PRCQ_OQD847b_MMmkadgTRLehRULOC27EuFt4

  {
  "rol_id": 2
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:45:51 GMT
Content-Length: 36

{
  "mensaje": "Modificación exitosa"
}
#+end_src
*** Baja Permiso
#+begin_src verb
  delete /p/usuario/6/rol
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjY0NjYsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.Mcxu-5PRCQ_OQD847b_MMmkadgTRLehRULOC27EuFt4

  {
  "rol_id": 2
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:46:03 GMT
Content-Length: 27

{
  "mensaje": "Baja exitosa"
}
#+end_src

*** Buscar
#+begin_src verb 
  get /p/usuario/6
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1Njc4OTgsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.E2KyiTIhCYWfwvimy-aIU1Cw2quHnC6Y3gHLlKYZrpM
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:46:08 GMT
Content-Length: 255

{
  "datos": {
    "id": 6,
    "usuario": "testeowachin",
    "contra": "$2a$15$/Ceoh6YccLc.1m1MGIS8hO9zzH9q8vresgkvSZdZYpKmuadtsK8bK",
    "email": "testeomanito@test.com",
    "nombre": "eaeaea",
    "telefono": null,
    "direccion": null,
    "rol": null,
    "permisos": null
  },
  "mensaje": "Peticion exitosa"
}
#+end_src

*** Paginado
#+begin_src verb 
  get /p/usuario
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjM3MjEsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.mulEYVqzcG_itph5dCtDoWyt5ArFZ2PIGmJSKJc6SH4
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Mon, 18 Aug 2025 23:36:35 GMT
Content-Length: 705

[
  {
    "id": 1,
    "usuario": "fran",
    "contra": "$2a$10$GwuLXIm2pFBq5KOUc27VjOqiNAv.sQ3rj8YgwooVcF7vxGgeviEr2",
    "email": "fran1@gmail.com",
    "nombre": null,
    "telefono": null,
    "direccion": null,
    "rol": "ADMIN",
    "permisos": "Permiso desde la api, USUARIO_ALTA, USUARIO_BAJA, USUARIO_LISTAR, USUARIO_MODIFICAR"
  },
  {
    "id": 2,
    "usuario": "fran2",
    "contra": "$2a$10$3Y0ACtiagET0hasOs2zs3OXFj18gUGZX247OeNQS6DW0M..IcVbKO",
    "email": "fran2@gmail.com",
    "nombre": null,
    "telefono": null,
    "direccion": null,
    "rol": "EMPLEADO",
    "permisos": "USUARIO_LISTAR"
  },
  {
    "id": 3,
    "usuario": "fran3",
    "contra": "$2a$10$idqTko6.OM4hxae7Omn/3OZqCNSUtsnMWWQ2w7G1GaOcqVVdJVc8u",
    "email": "fran3@gmail.com",
    "nombre": null,
    "telefono": null,
    "direccion": null,
    "rol": "USUARIO",
    "permisos": null
  }
]
#+end_src

Paginado args
#+begin_src verb 
  get /p/usuario?diferencia=0&limite=10
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU0NzU1NDEsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.ZtFxbDhLpSCOoqTGjw6RLKmwM0n2F74dpey8FLoItzY
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
  HTTP/1.1 200 OK
  Content-Type: application/json
  Date: Sun, 17 Aug 2025 23:42:41 GMT
  Content-Length: 683

  [
    {
      "id": 1,
      "usuario": "fran",
      "contra": "$2a$10$GwuLXIm2pFBq5KOUc27VjOqiNAv.sQ3rj8YgwooVcF7vxGgeviEr2",
      "email": "fran1@gmail.com",
      "nombre": null,
      "telefono": null,
      "direccion": null,
      "rol": "ADMIN",
      "permisos": "USUARIO_ALTA, USUARIO_BAJA, USUARIO_LISTAR, USUARIO_MODIFICAR"
    },
    {
      "id": 2,
      "usuario": "fran2",
      "contra": "$2a$10$3Y0ACtiagET0hasOs2zs3OXFj18gUGZX247OeNQS6DW0M..IcVbKO",
      "email": "fran2@gmail.com",
      "nombre": null,
      "telefono": null,
      "direccion": null,
      "rol": "EMPLEADO",
      "permisos": "USUARIO_LISTAR"
    },
    {
      "id": 3,
      "usuario": "fran3",
      "contra": "$2a$10$idqTko6.OM4hxae7Omn/3OZqCNSUtsnMWWQ2w7G1GaOcqVVdJVc8u",
      "email": "fran3@gmail.com",
      "nombre": null,
      "telefono": null,
      "direccion": null,
      "rol": "USUARIO",
      "permisos": null
    }
  ]
#+end_src

*** Modificar
#+begin_src verb 
  post /p/usuario/4
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU0NzU1NDEsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.ZtFxbDhLpSCOoqTGjw6RLKmwM0n2F74dpey8FLoItzY


  {
  "usuario": "testeowachin",
  "email": "testeomanito@test.com",
  "nombre": "eaeaea",
  "contra": "easdasdaeaea"
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
  HTTP/1.1 200 OK
  Content-Type: application/json
  Date: Sun, 17 Aug 2025 23:05:50 GMT
  Content-Length: 36

  {
    "mensaje": "Actualizacion exitosa"
  }
#+end_src

*** Baja
#+begin_src verb
  delete /p/usuario/5
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjQ1MzksInBlcm1pc29zIjoiUGVybWlzbyBkZXNkZSBsYSBhcGksIFVTVUFSSU9fQUxUQSwgVVNVQVJJT19CQUpBLCBVU1VBUklPX0xJU1RBUiwgVVNVQVJJT19NT0RJRklDQVIiLCJyb2wiOiJBRE1JTiIsInVzdWFyaW8iOiJmcmFuIn0.I77Vj6ZTNNGzlutYPrmomaUhzMoKHDG5LfUgmhzi06w
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Mon, 18 Aug 2025 23:52:04 GMT
Content-Length: 27

{
  "mensaje": "Baja exitosa"
}
#+end_src

** Permisos
*** Alta
#+begin_src verb
  post /p/permiso
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NDg5NTksInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.1TWxUvba7bFsGrNLx-uWQcdAH9u-Akzlyye40I5-PZw

  {
  "nombre": "Permiso desde la api"
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
  HTTP/1.1 200 OK
  Content-Type: application/json
  Date: Mon, 18 Aug 2025 19:29:26 GMT
  Content-Length: 2

  5
#+end_src

** Rol
*** Alta
#+begin_src verb
  post /p/rol
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NDk4ODgsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.VS07Z4YZHqvnN4m3hb5DfuJFD1bj1U1sSVbVUk0CAGg

  {
  "nombre": "Rol desde la api"
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
  HTTP/1.1 200 OK
  Content-Type: application/json
  Date: Mon, 18 Aug 2025 19:44:57 GMT
  Content-Length: 2

  4
#+end_src
*** Alta permiso
#+begin_src verb
  post /p/rol/1
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjY0NjYsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.Mcxu-5PRCQ_OQD847b_MMmkadgTRLehRULOC27EuFt4

  {
  "permiso_id": 5
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:21:22 GMT
Content-Length: 36

{
  "mensaje": "Modificación exitosa"
}
#+end_src
*** Baja Permiso
#+begin_src verb
  delete /p/rol/1
  Content-Type: application/json; charset=utf-8
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU1NjY0NjYsInBlcm1pc29zIjoiVVNVQVJJT19BTFRBLCBVU1VBUklPX0JBSkEsIFVTVUFSSU9fTElTVEFSLCBVU1VBUklPX01PRElGSUNBUiIsInJvbCI6IkFETUlOIiwidXN1YXJpbyI6ImZyYW4ifQ.Mcxu-5PRCQ_OQD847b_MMmkadgTRLehRULOC27EuFt4

  {
  "permiso_id": 5
  }
#+end_src

#+RESULTS:
#+begin_src ob-verb-response
HTTP/1.1 200 OK
Content-Type: application/json
Date: Tue, 19 Aug 2025 00:21:45 GMT
Content-Length: 27

{
  "mensaje": "Baja exitosa"
}
#+end_src
